package keygen

import (
	"encoding/json"
	"github.com/okx/threshold-lib/crypto/paillier"
	"github.com/okx/threshold-lib/crypto/zkp"
	"math/big"
)

const (
	DefaultPaillierKey = `{
		"Lambda": "12491739015082086670751919580842461171652786082158723041545076493462996646490003610605302802777412119329927033726828635409902134019877944906602965714864970529604742063787080934873286747232431342545971335838926321759710211991570450093942606043170942877300385053343839015918654129458983420596595246819194392854111575338454015961433748063441078688060996108945543514615722420391650063641038015752573298170417556349966872377465142891628772681073690793978159353600065167775468050866279892538995414180871018398048364043687607206451466730853469189831479021797816835285317147142571547569213925055462581722719747263209783840238",
		"P": "158141965208038634706786673379681980759259992630762691022551844842383008880024004400623684965820267730848900258578322907927868891577988115617218498903115357280160086046791365589867272497520443510763726092347599907311296179807337010399064509688218624190969067255198217728676213133323847103123033520299854914599",
		"Phi": "24983478030164173341503839161684922343305572164317446083090152986925993292980007221210605605554824238659854067453657270819804268039755889813205931429729941059209484127574161869746573494464862685091942671677852643519420423983140900187885212086341885754600770106687678031837308258917966841193190493638388785708223150676908031922867496126882157376121992217891087029231444840783300127282076031505146596340835112699933744754930285783257545362147381587956318707200130335550936101732559785077990828361742036796096728087375214412902933461706938379662958043595633670570634294285143095138427850110925163445439494526419567680476",
		"PublicKeyN": "24983478030164173341503839161684922343305572164317446083090152986925993292980007221210605605554824238659854067453657270819804268039755889813205931429729941059209484127574161869746573494464862685091942671677852643519420423983140900187885212086341885754600770106687678031837308258917966841193190493638388785708539273972354998302587665671840118643139411720339841374575681447397692287796788687196018812537314238740858156293681800360286405693056915543043387699088062014799697180777137582489576484033309360223631086742278679358045718614353623421718278707368631333401718041979499820374520625660304958416156593579513482897437",
		"Q": "157981330238927745013382871578279286258159509817991654321684761772009151634688651290248531230658858310075511280173191669100991439331545839469850492984816321968600992997786431821718383174046879916770632562555865037831488972839348031656256154084779038640114680439158507507416562416055947867594065532794060302363"
	}`

	DefaultPreParamsAndProof = `{
		"Alpha": "13756076524389200800498947381561426378552105314964148183558490694794328898375634399897526361201536383644046320842345233364770108516002437431956512224564155455793958499048959522648974292179641620189638403758677941408297573256448529511808083676552801860298777997948420749412234643569111280704362801935601624176373381359545166614028875223394665292054678281865655788043472347412660234558862187704887958481268245992467134575994366778448150424925935253598389025583229733212048468606873938477471009204889904286741964539202249130201288412866588001450267208698236954018249882509752976966536445584574339552265503048639890762279",
		"Beta": "5100049101035290517703703014177677480833166858498401016332518715718761708180814762137250269882416966097184037974810290445580392905975959533891035219771762938943502316387492222288424719480103586994476482513689733097481321489005968024816917834084096428178436831783413220310442357076219824009665897599415885201649715603302427849688669719319265703890960130028307872378096355762576575774012968025769188637545907093265304771708333318240017561212446041130635436868093662919173052077197739200146852094017047236797513475749825741556253517960200791349525917058777484300392818119571649179816901825917491288561992394157792290401",
		"H1i": "6938269886916597697751370450956171086866878150417759237556109955871454171690114811031120439920934031864258950107692074211064075117626037838243182997144329619011719572060767463392484171345271908668406911350767783554086134340704265849752335908555368249470066089964027301532241279549752720382245577094624120544410169092708335345913092384022170340352004283678355573899862650449138985635192971619815604868780426369222852882379217887932219782564089623381233873698692156321764414116053424447096424442401649888505011299824269178023323534161890745838101000948475956286953806066047799908080900935847593081612360385577193859158",
		"H2i": "4509472594782897897190888378407839260538219466216107676038187831813737112949500034121463129002689213987897572924935453985786448685801128249400297709395364100634686156365256209286334502012549141641675979460801619315662016564874605074516267559550610394131888305767960082146245676852828049452816823504860567447456611966574299502419885612157221809370636060567932323755310264726047790660237032325524531509332489339934347956050018061343004887480034487544388813309562543883318342901991996159054371540121711506946822118430775532089187632033960204950657074885732911823703961781643042020114571822389643599741018588625989529677",
		"NTildei": "29190494247779258404704176078005099239648986199356172132199427047869376882770889495672328401415358960761435328613065972486043310206645598486179808840841470867312633816581017599979126659983578665547243908683574057535583868872862359265640015690490828182662121030080299768499259709881527337972037828892497242096429365585490104188115176785390422002369051149528370577059973530093981720916582626290071939045436999098365402629528352212651039910800652475277047266695624345611065306886069267923004483754015620570959629248906797815233702732214021584182159623380597409209960928636362262903536122968954439758139164314597277270493",
		"P": "89116376315134774571079871617664648433592340745998979904223268019896617329359950039609781657414714553206812584288324175105958564569573638630614221175930752592867160947336011244996975993248084461908226704566388602654052454284872830308517247058694506776437446925349550004277732483780005172266532493117326851899",
		"ProofAlpha": [
			"11408362794836988331730557126122167790614080900212861330312200718689499166531249747473371575186610022298626410342456593816782451425020071160080524322622119480114926062551495432898066864557483680194146804067591225211533315378127247289072460561919637517871324327412998778054830112390005250742180343049975118505455798646577877078131554478858810051937719876426613060946118743779499056640425210019577411172338130719921096049044297907921516074109140142215496007214631411999602943693907247602688656918708996563814294754932624803018140437031071639251886510660817217381368556009947861428827334044751168019438197219497394371694",
			"13225112881219452588225395331094903133841189776801279298416472653422511809903858784119033114881124701901909701214227342635630289853313397951682357459576868455767486405386131894260456673569656325704684945420028770135560382850798921185828030166562877985496874138866357931027164550060580102109831963353592604340042890231909945888493237802483685387627070704033720450204083258614437205145392701884108644133115569210486814711552488053168504655142578881960248784542053635235180868532159925986120351867608156417976879898653414020113908973048887584524290213403911910596230149634804549108325098728491716951812461131131164115448",
			"24660766099745674629035536670421120803047536332504810039919049239921451189470151632525097946142242504742466185770968881903515459850233888276589796787381474868652442088171572951401899536021462642060168505370324805076007518343833843791031361462783760041482578436010769895852236450450710600178057469012376848716604517937509402751715580371099261968213508569992999211685055028103780976016770730000113654243254472342526176355961987792500914089843402584270431851378698337366238231705841925477819158205018706080108677888837323417518663976074026341883568528115242808413315584157853484661747337813094291294058102703947668348295",
			"20173928252097575308051818325921900142314300377144951817941535932432892473048435943504535383177956485385378867048693664283804153800644754453264725921254715465663394313227287112870064676393858175421518737106206884282318617982455219558643129591496243234446571773851451523244155811313638372106031385603175607956229247785760690266453619460104936297154025651192275550910246785492567024594321766386097253599205563341337488377646238954686085631470762507623335814869288184486032926292325667500177684097843724219193092913901962411293564104474131074437505577729344902985848707433442241393750018672869724611861683617128893123413",
			"23901406252279259537226843550041422734341581893492027048834159403103646445688904998904182743565362769930953547096640337482130126628443548193622008241967677538634773684189126654215733015498715382723331627182646913026744981446912163055866291735239879620009918327764868933408886918133974682056827990232900999745086523066773981610743615959223962182840449679459534288830705593462972707394597770580518520915114602233623266077766359638390425454253374981224907225280679453968463697478356122106745440086102606133285899121077977003646836446151552475773853725033300070054962625808962466655152539949446982603775555402289099330443",
			"9977508120978416518041744393092293612783174445532608046838679132118758088783423931039593660386022807593421634255596566664447670230168429253401472920600294599916270181426894961601632026866778453727090273322475712403251572184148872574948424765030311116744296291752279020466757200706847596761846031038445208897139498478994181078758188733502980974377600056430272061125027464513351020966653959511922345891769349217834431357765273564574816245319078654664377064360310630227992988127713763707756088642318524623870477162470242645939337629901937855040975746106847731113184140305842600323388489603870613526645840488370891650930",
			"18602668280255773248769623328464600233656019542941509095146990348242777525485368613783862024177199103660176507766511275784071805367505685975468709368743755514526755680159832435609941210961785685158873431090043836341695454580343575989958085907416856775599767391542705750550301980232506899899173543081889077431733925523747089895719823620822211726316315086280936502908391203778160061564566416369028135301695989280512429636626717120694241237130312778169066427540067853781946524480973299737140789697658317753872334106009802852571525790731020534307864299735824155365148776920755040444432938408292427957387297303711498794875",
			"27720417406726170193732949309531290879557535201279760600051139979979201446809146463421263723619805268393754835056165515697986961034331554007574454314812799826409859543291317942479084415409194051876514187583995646880626539575110285157945429037564975541170247932147552729130510526214245167325540608220523822328755634275047833135718281556763749217191611233877844335095327852719888111905727346164773543256903617701828431382932767823511539019254379347863504041024363782085821003731447268744198187019958858191523282290933069528067901738345859452854277255343993563327101183833401305788959300077053369705773219377672601885885",
			"10810120519523429943342216994129496942147158692497686644883740576993152879485777634655939689964755324104334836352776339051968403758618938995283381013521817084448874242158870484898220167889756621709104897514683875519206987751515899178068275191900166074638181264766406436594464839366454579097349952587147852120064299964454125679092359181417394470893505050262168043883951980282001249648983100937122424257335643037023548714231255362632399295527183005764323934838222089229049252755606330689899083519789022370799394082183990611677716265346576324497378394271383998329743693084296678459315894931547594616107291754066014793932",
			"15198412960805739441048811930598072392726020540977515757565305750951075742401151665120761314838850592678240791190753586604363782094593264672413672077123304707673878601003938288453135230770042312071277647303052957904202316316120966768938926448303807382460147096215167634156716769293272072645722374050443610885744375871558252828553624267767614332413631152256255113362869773312241831498016947042010103454619087795884136938658567385289882290458307541177356006905855496411763746759277227006813483797261708283914580439917884914796079525259715593898844269788149253195205949455183337894452119505434287929846484272991311465579",
			"6812149352877133663628715368233244738508636640242289605691460250597307882160974665511114307435804912614358737433597751929093799590662722021045694091374459035026076867029608068832927834603783602900613727989882260237401953104713629399170553583611691482794614948051268952831723646706845211976551137144872776630243122723104179060809533323711353121348497192641186518793801834887059199434304170854591736254897603209468589694629259661803598345563739560262291852409745568882922763116774527953630728560210225318262825733475896871011260006855740768025955652318228078087918937085043822657623391273005423354529197997587500028877",
			"1503865430631533353120861570157770635751251205479021590823297351505063575770942395164374254062544935792286632700400808676400828234716080700599826644069664671450076885076965576177989599687528809808476628694812032062131541240363836029782300338781348148522578782114248608969958757152122396782973088126189262737998958759782482831484287636845529323540342205606984950451167551852544216938275450502332122822681297517692844515856033911351184390782994702249778207090426116406513982516899372130200727114371142046295986622958665147654371165221306451312404541706560298256559777316275739697725049949965369660865556195654830481058",
			"13845585041801865954294361950395167025582201365632388002655449054267922486434230116147930040498663740275415384426263953264761901204253352836802583220812672931731072948574806748141682320586863408326339696053068907199010499789706473461100786349502645635907944909837612130821089215477672673671881072724487497410339733636762207502318234087620608384371130289359936002128224573648194207727280646333001223259548311124602968500080787035619038851552243989105292874768555987623186812487190864529069253469507449725520738688434806393476231676143779179635464873346504944258809794987243311458355177754148719927616788232735776680352",
			"20713360068595915594137811158613145443875723306594725113760746334332613440834545538610298661231848877912267495561233526349535087313356560917735107351435969470173696337985177760934463041558651607782998147870878859550999779337691177525889025683336791651947977941934337879945192990765554326069632236063275926996466250394486731071244832768496320652898083608391404562633125304364915199509729100425101411494143282783409449681366835005136818165197341678198632499725835189391656635877909341170166786698407102064083913299799049530220418734303016707969379601957027052841887295983944112230115630866849966867197462920432548002824",
			"23458478996814769075933557551826311474555529140516716026114763330507252435413578039045465859198782088939850207418094522294992352996117712991581796676610398162590023914405814665982237622532145880370007822035961565298962520380806029468434943744665537640152152108309409514427574061490864898985051312261604142023499339656232938925982082666453379240050523879199370565366845725114997397069894399204145420397074533147282555182261636273249027689395572363198245556589367437597120606338054822100602338042116745294348822927166368587071871637183372556770306796225767253935513148272832482748312348205953382619567749938285741956440",
			"27251317366912004846397238755641221584080913096702294293384747831444224976615678870453222353221830116566219661254778334003960309635507510086428286989220658267446070732994045310794409307103483395764350441239192945790021091394176749773885820095814292242930570811601071046028720482542279083939143478020044806070385468894281446711012319395890264328320182989713356607732912654859581956236221180852623581425176937444635360966648400715884061172335704019413620546558215585394746757274563978195040322657862391359250679202841673512255499277418494360422386335149225521042848236918860746220292909926148965189546262104310964889578",
			"19904939849885007171399157256882023743132903700434909705240718857402278994923241439504032158304792992383323665672318725472782335096198560104844407145160046976196629215975803588054347841872811966829936311880843004901012560452748638213987852371154252520496157299415007735874508796819771509777808971289146597374554360930058686711254780880168065365565403268455928000783295418380567213890211503362099714865076963532908641073765782141914102310101591153891098823646823018708690651710270850335258247894175713899182277336144297324381965561761478314820904131447939403310870876320824295845532244532703567877667619545272441768528",
			"26663397669751469980840360968915751236487370052455567144536666108738816648676731500485611466529875755543998218574001889224500117340705621634070093808238609642027314677272573626361786106916285052021488522954603970681233736137670177192862856174718453054849584333832659507843935960388589502385023955960764817868858455484077355352349676214200032438267598265717327941923470596560209886636070369559743729071804533672185198786531706331685836959205534227583686506538528428822231968960835090795866188397945828598643476632637463692378560306966455039701876004446573972722069628624563564790515297209613283472655017002668593044214",
			"6145633677881283237697970445136526972620139285307486288707666962777137462464590851093653909302807684267012955630834257406485862345627089155518192983853936650690286831708492212397911210029625386605208965734082189305451386035650990698379785188647579111109037926269722265664373745015478639550056215462972410738505441471593824095477817261157731722934543001288380265795644683773347064196169148051182418870047792132941245753515486907940207347442799110856596997390821317340279268511982316295133593941426555480920156188954667319244608028256293097628809089067707449752870049787134587541270098714232964389368753179874459749885",
			"13876303463206839060482604212659976299006316518415174615517592580426125910657208349820860071697833260102119373711519515977018239538406947105518129624165256195583971865183445810755647600813262294614507745282021760487276696342802962803218572740596353404418268383331221595039754367864838404163159742569221106537947874918755335305786063951826756176415430811632541236104804784271377118566136279628731801721410675200557165029788044430689438139840886705244130877830478137955279166990758510059065251566765629934071637746477568144969229612079007349500553863034396990868447575787270003468957536236913141898338406453222232190996",
			"11756935901214225155678964567119642544008368282880477183363689179578292251961357746234652990348233163360084974860929023689692218620425445486641480432228048624815809594838314625016147152427991549764345486864293985699372489354636596796301710956600060263168513653516435110305791488151442785868107269902711627225171837676216809034259330776811069178258580083537463014032501286350289267480330320592447277731970682648062366220383006826008965935652715623400410400796227132139999208773141504153402249253956354053050313485984227943990957084625973162967383344202147601126287443605469768305656944474225106251760410502075855754866",
			"17743274588176148876912112114171881735588810043266689699633016060456424076315811616217311029235092873625867558135347970804057620292266079292621561892667559699069972590339403650020155281012705741625693605396204552397346508114452178672838872458997876021236227508320215006065014212834434136965846978764209551172527227965379947991846822315771921779875557003916415387169253242713070792367447706210420132482434173426222801124685298395197848820278270082580767691471676836069209857007088046962914011610869337823598066191657430331620695001269286112076552489337106315282729623267254777008823649933364769029759006878051873991357",
			"15345998702638251012320648468438911723206685473575913652502872635598592782867256300956994177152114108423758715824223799897200332712563195690880564094666733258722215348733293817195745873947469177554089967889505942005235106002632987247873464994127996793082014771479344536421631569789413684630820251838315728995810228689632322471320483798382217682621443889648961411684808080044929984828752036515174773320366478034202002067086016674963979504408165849706593544332689143962127737566934113157718371553015789003001247115495099446005006704999294062229698309544871014156777109744523873238880126640844513818644460477150728505648",
			"14644711892416574898124534011275117462309932712560867692641040858440965230377355624916434350345050774660334379118756491816563579315857526866112770512733633221368737034627013599460739792163586502593125525852099358382282816214510179487550669853886526717481911355938342033888732574215402181720556561775694617387536741944220344315381924634963570124965719254547178256724176137962124337768183998314673142141965285854047062782875166594556400509968418400637613622189169243842490929560895421953634070089051886407610269698275701579198725484305815305617719970722505476216800585774121252706832120378852636270667010415217485878859",
			"12091079389162657989063390078083486188900978279125634642817360890773153489203515778864990005004316694668196296476916128341137302156884289718945555500639249085619592332282380897006042985827078441752491852954849504239054619103265408354106061170183920769345324384346154002421397761587731197775194964526149319421584262317909955485591799113974921551517657902543374980439130088586986084963091925789552839362342160022403915783430719213860445400243645102350825468608105560227959746635848138502408837477260282850349135953117603792075953762820205163886036836507495653097893979634459357253908750115142372621188036754803138417776",
			"22257014565958578903917974540301061942103920104577452129187015369377369994449150051149328612090838903630701597399246079279171772741738132206035448605880027366093211461839519794041895307439151928092310452835858673863111370336363140445881348251367807658642969605121970777944845846720985438025234361270144907938029585837295514312860532477423898997913733515849468258862483413905410731964812185466734045687224785593807401060855062594904517351046392228918807324218499543206761956712130763848346633718724199138804195282839575053881436316040954212728573841273007825147161256056008243848489590471196023667379616432669820113039",
			"3847572065164161512456075889792364269021432625410715439625900552597554907729357820637710103285424018637280899357930861382758426210520843744967862237485538523882286809086526222077881003528837927484056827251796989751624710578464071016783419263106332799849002628076332035061675194758323964514065291986054955654989532682004183852040287278831220329676070020661494360141009670785233798392015619085619483575990135954988873873428042421072616574118316606375497433550614552244648069258293752291679092344176567332179663992094738002127248362156320995586340705603944461153426348463113652907281284508531818808512460087883440158749",
			"5140667765670825240432581173626710963510618069545972006534313708607701317276490747895126518664539049027154668180624347708852155257055247074884594530196990925024053622134363481796485934154971477920083922790147865702706625016209627116230530113499494926231923545223611364165176222481509326741838254957844171041353730762179061367294189773861884145453831897689642451590334029682228191326425144798186193387737504617754863068333410443486810944798761298895341692677245756464427174906081223998610337943694494085300993706836170021171913763763780287103997882796875877555240069582621432207823466999040228054423138239148773494065",
			"27102821930802022947094096060545554491003180396310315490774131401403965047881008478552191214984576712166694260358042559834299109282627181086941066425595160390605628203056343412821854329110980033315922358469101975617920021930513543397785151417792738707763297794249009452390051226786064568312369620782236168228713137973743019757995083038232533952633901936150571831100966833181353180388345357280358581043266186654047219728217445638484178525172549816327265476325578787463759244954291219423578175006305982398610231135963706792357185275973226958744670524247232564466515032220974120324883039659550515503908891644617194999595",
			"4462750702017354528045916113355264506521550483432545564182633596416002063335128838963635877499519575526048601643483649856127141688547740650873414922128205318883280407512610924512127747279722669747130088620346156926616506570543276909126662420970528255355643661390038345181951077878277796794410319677145257045023946333907717238929751945396330938129294999966056172811425686092658317025422873542283018548113334750480472403704242599632387300486539337340633494534926157689791237236467444085215262699102221798192801235864805006924215181844131536739624664461302425067820513257340830278657592078137446391710672453746533486688"
		],
		"ProofT": [
			"2391829954929188709747473348283922202478079413456683348476841927587579875342331783867496387680238264610040356090837632027885493104623566782237351202559928169481174618317011925751228004280788005142492445952814428628073314734540970104437124434265410122451772626984250642338274027200434292115901188313322982320403731909017361615494902190707255974253057222044558723022707593790434722265989778323859139350180937129321768177299012162554641622933669193661131212660713886119760699887955089942738330701944675289400491845005008070303089735080730036307514938403921648266034254708822447002022265217705323499884340353889788128270",
			"4132493165017249809603472961380919272056519546660242053929397972784707893598961379001046843936898511590438912584157068521381347956275272139096169802355531426074448471158447146527058090927177566108586316268266005419787826812668808719664806615461313358952282280917863720751906200281603853992117696157777547874115216071735949943185121013310661683884809681541102038188343540214537905027837773339140804101653914104354852665379390960136523714784232488311680224461069225064218534295374525394864396140344760843141043503604333299723550911205671571697842545718894248653558493897251450172577733111355003350250866174448921651781",
			"262855783027338043906632244015395691360428145537169722675412931657560406276290695762624356498801540946978340465419436248160670796981011859407286770824079792709076568631758471476013123977319367229442303593929135459367307605368854275239368438709829230864133074095123094629952113409644092149555908065688883792298278699554009494439389978465037264641715723895185523827508561759062643414786823941675078597252004393912654241601446486263345944150156701813468743587463986305914180219905029459085545125753748673976959007959182900562914533483669205224892365137934351378789683661043097479962791930601864371611432091019636320781",
			"3136978262134949486018359085845194079679094063647843806711359444696970681231764861425267647255961391886786261634784675227508982310334664549653367064340329417833382798595914490779236773807642628104194062494894639200019348363322366035800534244112466157641346200862228225075395931294204808248015638094393643513167332914150579925505757362449033070068875209863348566913067232362101719946748406847435173007667986966480995075581053211009997530463299082232660516862450045698851219878170051933358108687720307358798393880262455402258807516025291040442121786414848360327839881349368561249985153061625039912390212381815802020354",
			"202209488674416414884533536354289494242344397207880123769069638992447126422311551423030524948354519409345937557559330934779104720132193323002331967803537849211710594144841695989230928889880917881936519493252657368214123256208351210137703141908441090171588630713117457064352050153243843323397883581916236622239979215734516285199857266988542016559898012390700550191783138727826325651349095609754905225693678066650596298845429221161725658248565344053002088563764631208507860710412198959798497057393905056754106440792169519000922234627145829213532451023616012379215762202853642966004359011490384892748251452899888138641",
			"5964907475178114715932055566892911844951822088568071904270214745044635014498123955868095861422834339764185633870609412242090391711696422329726912713340026689956941143137550016109262178677126465631618025367637416879574615485726972815005360461306328750461700762338794113997025443788967986599118359616153642296741492110534939724855893143701141930775230352881565995673779443296970413454447569507449036317791295716458760709594384583245045332496664981034657700848391003253524235687817179072728009233380374513632500814210706525932434530482161367346509755206307667431743222089152671117827116514805881592401670612672625871598",
			"4658121456107658368833477313189676551970321216630665090849581436957465818912725653853055586162344791064228610921124181575111569195624728135217537820619508829140911931322024969324125946164694075541788524985923091186165243181990072661804351272618624109587991932153795054192553829273291722635296553641619457079924342483770434324319600116611100669619148883159711235943040420367945608760330228858417631750727883479816347131130371505679615031310791381740750627911297931208284204540004224851877457140395712980241989097231808678024415376913802909112115354279585888354126103570936693938647369691927414327393629741510105978835",
			"1270399284569323926440498900315521777479322605096734266295194770729677924843106365245037269593889429080899121769366722324721546673027902353008285504588680696412287721985451731815515253478315402187278383978435391788807709234400493653827365912800817182042196973596512470535408274479677892622566573874081673117405071330112835004330829736759373491210594610030163366061910328513832971457032484413555581015671882095745133839042262787078260941783067012281504518400637205050557919412234056250485618429967483834211833403159233519579589399216029808483412163333375256004194011820356555495018159835459319594372470597922948511556",
			"2535798565032400259319969515271000731145673358566395461888639197460528789905666527845760134794466825808359901126693895151745314600514368554118213914238238225444547741444829112978518005512985574915113396521230240886244611171531522472003794417188546184851809058685717708544313565146496329477953539151635900129181188613511723854479301136267519433102504178908171741783147935037616721636424934002390820162141028080341448740449329973528982154183132682299593890753807783681121849220257855833661412986440885457255390500459724758517189034940435342195237241386425563670693911761243202774981539225316025123753573879446388614556",
			"1681632013694854966072085098470362889969030996429983700365655951437580856849259492536321231331251376484345014693954757192043588106855829545744198603632801235583515844510917206623086081358712178672292279356140944441706992934884748571011349779036467744906855183409504142954301520907747574550731605068591332963330104833746715125574998474610010030792406910290988253659358729858630318039363933553086799372016324207571182443464968426657579037529575095490015901482268911056030099024903856637441711773448867750192236808006511969947065370460649381811774495856513823636228651927306675720225472905988727368003359567513085296186",
			"3239258075401815611664766514725110813997836658906114895678003871583375077451185926740957165114611891814439190348741411414318389290867016480559155467470410849905862197209417598266042615036665031147515152708869083214773299944042122857005554554973043821828424391092516142584567911522166425959544627894489357815918529260052879456223496047385371372563377059726984615199244361227334092832623952095055123474990094303723218840373814770845067436100335366753494470595301034305942313072633651317312357166632459463637583595233696439584053337386299726237473817764143202162581411801932734222898433419910222625694650349316661211996",
			"550701812648451505749158235745289579086378533719290296787891620698879066977074187437094396543105647537871866512828957643564825067960169207735947552001283538594030133050397193309886087724473318511140517436509699113062403666539105205503254593359268564718847705728346559244132979565471051215609949683454869484857313398354459917495290690412995564574203935698203526613536186050451988178787214647730656357317976182195752893643332985454838765219801569690090848387768650811915642109005537269418448067442954809660133286166551540249723901545244783619376805727509402631471591396210232118487112342429051893209380184715957950913",
			"1915496531514657506370393993058703012244192399807010429272887559323413708394576545051208366759747647516394461217255179310762855331795392502390517803670916566056126861322713748143934947468758399076939315668623381018599936168379169345619466712364306445878810282128044093861394871223317041761290389158724578053557916822199044128849380104647931019807040343476879265563232226392520184475774190722834480787012563473024287074628250313011766132389226461803962149088411605635628270372105862799762636764271996291742993996588086530909102073886638222162237525666046565312092859513456442513537145727558554173880957213406608111336",
			"850002352658833293889104675548549127054213590470422635938087514672721580793354827873337323228383701241420726313742851555709850789002331063282340511823001476211713146589121375868089328436995513613902894353230930739641878189259319522133321155007357212104771287707362935129948610070119666399406674275301177435612103814685219146385484849655124778075166396278497745356467241546092205771852099082844465411056856206212061062324593988932100787104800172392188971424887526474271533330520081123315015067169059087006272816745096349570041880473817844222941020183611231559189361449331419757724920081050695336310839525773767165792",
			"6661801152352159628941940762011678907763919066785640651148941212062470288402816254095544026584918849187342764212365560117450511151124254677669481398320723955514161428095781432443614251175688042863496910235016101587849301850377039002212238884860028303370017999942448605390700697597496639469766620573121446593706193950511747967317610994244515670018075345327899159243816098677201144420495517747946361738278296190773037209574695238212441350258995243272583228487133936903245124732605236975988209005586497587640254132513370663261877014396341837235014227112715766613456362073011327589927284391904507558709081259788846242533",
			"6026282635672064897265040720247788256777176780310883023606132099436274231261635954790439345099291020504752087379424838581156264579923490139200905710836569287737462757184099065767666485562820718333377646463431916093649209260778346403611501683442624485992604314358206527463316249050634166384126382807480802761457538953883025566943217783115817793198089163904846098926231297143580032294173561386038518306311214023503866512634317878406586128755878865246068158645397637522336645313288125582422159683708902113470012996918720616507649227154076449709858126807629462252991993702276841586550447059026399526481474725854712590298",
			"1682851184894981928776572525746629413556725691098338113204963310191687500229303018072602041420400098571792636211326740674169641695483439832831677939237296510998168335241446184455863177998354281131755070425735842059962623550961281274052927147709587968931842874511006878611872050850876215515182384108661850511585797109147424655406515412590481789336694181958329431828394978500885383735500623216914626135416856616105838387966775021102237838723106365152578917728405668679428216376487516145704051324650032027577729451709508026094727374166585444545956581024962561412062844988944549332080213062823084000411989711176454063391",
			"564372798834671678051981042909720330181073435114161034631905840545644031135962948492480377612032658047194896800500038147869097300541994940069313349186549854710534776896286036658015242328986364427221742786609019914008440778141363140117231724437835193035519416698403941711721427856358048937668588011846850310565188108270724389976882742683644215924370630530030709336353226239434551073478395844514186026663325907951703413567850125068175508379724002844110201850578169682547563801032809484503027275509723533135943983478270127568650465937070807937690871990661570749284444155334193617357078852722300115718400794948613611646",
			"1648427098221446150669937125109116935618290891637996871957221648038497608563258177356626868303144660935503454375172520781351954083515520322278017089545567690958079693193045618003689075993647494762129284619365422176142709146908728367396146696455789588190663917548883665680243439712206789551503643841102733226180220378836778358635371932618845918128377036526524835315622771515338346202122810384519682304166649339650012017677004607469536313561013135398692505925823988966671412016552470174541510160130169100452319849293596960209534593115724686199028417291156427850451437321827831101882951792640196529697779658212453524140",
			"6716401888597463190752074310363370616949066957114415433007995432570517419462665112697687365934280124294718010423049939468622754215186943968310620949181843322410919391499237038427576544335927527054618729956135601688235353899578254811061498487183493868349808120769838884841668561537319861377134597099548922428684545635810554145710262109756945120974175562247459337245371899403981840999862299994214038799852335881180360840489731370550978551405511015227291763996622373722863813526271255276200316939712311783529206370722348829519571739360674223174618738038324457913693111843710605392081910035792043789523279891802455170944",
			"6002719999063042433806747335792083184777301481425972825885808590344114640544596992681288740671728239954338692508813804867614544521391791539010931055662633937500190524658973544330577325079909780407558376550723401134678802626305918768270790945395055838305064984600570785870533218363806522270889267678885212541835598333102520461273232955786992398821884916289967171768921593618488591461483006020127371321399580847757930676927195971590778905498478855000669114253077089826080918570643400476417433867603928605239571605019092663996444663704330820486472408926267378123106295323971645171860547133754479458305664606008678529171",
			"823499843043107804068753469810912949321713058023928433264120604552008192369345808314302055338400341514154614002413189953758915981216624089346922561670351196527564463950933177816919146446441333574480584370075461040669150634982556971642199573987839335951556981019756249134835640875670716790866854047715801172336606706190171882143555086199107013220683687393987159921866748712689656547850665406096603359091697041269926425102089571652422728584245259243101735143602621359606644713570441447128608966558333682811791819216388787518097544571032656622905777228100089234051030232645878479442109372821763669382671216414269640299",
			"108985935839875113790221064183123320689990506855089088494356155224573270579111548641780333126716162103886753736920896281503807553569151934089355768733558136665694628237934215146253184562758495820262106670825391801793661779173862507605927248700265076756685010870102914609780743971402671904775965398029314033714596065607887379604979157670659910241151484266659799790286077769237015020240170018708633652282626969188347329472606136308138878499182221849420148983666747346485380386579905078958947666618565740105403022926556247521840600169630646267454367610846800674362974694828328401117437248501257949633230779093106104810",
			"1004246013647756587703242325088042323489858228053499771218485301734535590388136076435704150151403189920643483678087745500823235807506262151586383810523002932351728798981695420993357017462318646625353844744146330088506582951522063949376078874639602571145855002700134450389319881816810927815148085616029732841425532118605703571984422143972858239482726217766710870601069681002637181317630021858577019949346999219329549043481168671700348950984507141497032959794710259563225106697286276062686922781670817353843864361946925068326844095571702061268344770826140071900102645047923921310990098688423555036065720871541034431098",
			"2642470076651351619444122728232734824773816126304054716316171634647417665116835430352982409796923716521332129324826713357376290120733678714631258604110237241145277015768092068618424366013326435105010103255700588104066458075322010169596611129503273244498826626710630301042511271702284377862221666612926572891614270923738345405278589712886461816063051939492838563539025388468005120395280122783922591784796141108973631812274671044978836311063514806744424258264530255369711531599903465450668662250199079357471545122464309394760678198941638668730738217881134800168117843336994972235320846295519406810822638349808346490581",
			"3868367127368722845588143242247490485030851562495179966013482879318638825943684350121173572221442227608334192557534018625699906060410289755232486901479720143835059593078907978739874637040533557111050398694496369643147330121581399766074039114408760779427090509401713579061788041929432235253544796558301592526185996563287855195277041743050123888294197937044090702031795506138441397998254847422239532411726876097791420459731908129894703269347815369932680552569945543160326732031738456731866611600123426154301710623817117135972983744436614030974026565686050872553428841003772390824956159089081360376273350019889867983822",
			"2436521231943340662638200570517354348341208055863966246628965660057380423579549916780563834067104075940740755515297982931343598678079188820802119635313948862015084552359895754330047323209709024188380749766554625820631798264006873008926112145179637446902961154453508645255697140000688371920609589237197143689057959459301644611445341371360142742171222358760922732018853781121608741472320049941087998455977417514728010384940661352412530856256475383915941753960456962439500759984244335798159289790073423153374977174474498861145339084718920042187921007943949762708968629385454089078703757165208743606918734184039481123479",
			"3764546069158468638309316245151709398805993575245668543855714507586188542336839816033830058818424833879603161514927409577086609228105362700671827829935211751861364189864850465807118317206781474132382769573123554235012743263151774562547291056774179241629764713466693901207418038848169532875762530662328236068909886506741888347760627864077396182502908479390845567994428198013419438419520808131886449704172231087373764161976779382107866053037642112656135557557541351106115467210623758575126423828790262427843599240779327503242364561304321259566031260352322376440702115385445967257770712685263910561068326509724336343420",
			"587499648891052109662711793066983499098860214861382451937630844668888395213194326513633054664670918011209747032916427008692281643008348349702449008011267445045726222010767275310535192162422271170607907809227162724882093771246825648582218531742549542052877195588661162019292926080713397216831515836326517135139511999457205771024584149748405211696737263107057842570218848484076628680736041641403711056443852671061228202148752992590708637387850541171242156286312552944391382781969709775364213281147257937992462841482547076519944181196513314771234244763147588844254925853131135239366840821759576219640455620559356077709",
			"4014071684038581596300508355385435666500217447053461530813985959510313419853599439732448643704992481829885714187498837266040442941610736567464145473806662505975027082151584884561870664232271960477914847979189158216851328504865219660908425026658593717837543589494336565961448195559775837818354675828052905369086401110129704970351748525977956000318771981861582714307607237550111729564936221746664360906824739968034831008139650620124416049496897910173065458991132884112398562063052227281885946880117706294242255496363348709056046179503396386808619290325365577524795366893997174252100875290522720607839896315793718145744"
		],
		"Q": "81888692782332619330202999648199643771245914876191016808373349540593710789884378317885079436554270857977319111085279711908775821517136881873842988152326613559088511425613090463317928952573394964027930239241551806974481601840203320442962078818691103345798343553414951472514241178533964649090557248039022918053"
	}`
)

type PreParamsAndProofMal struct {
	NTildei    string
	H1i        string
	H2i        string
	Alpha      string
	Beta       string
	P          string
	Q          string
	ProofAlpha [zkp.Iterations]string
	ProofT     [zkp.Iterations]string
}

func NewPaillierKey() (*paillier.PrivateKey, error) {
	pKey, _, err := paillier.NewKeyPair(8)
	return pKey, err
}

func MarshalPaillierKey(key *paillier.PrivateKey) ([]byte, error) {
	m := make(map[string]string)
	m["PublicKeyN"] = key.PublicKey.N.String()
	m["Lambda"] = key.Lambda.String()
	m["Phi"] = key.Phi.String()
	m["P"] = key.P.String()
	m["Q"] = key.Q.String()
	return json.Marshal(m)
}

func UnMarshalToPaillierKey(bs []byte) (*paillier.PrivateKey, error) {
	m := make(map[string]string)
	err := json.Unmarshal(bs, &m)
	if err != nil {
		return nil, err
	}

	pKey := new(paillier.PrivateKey)
	pKey.PublicKey.N = new(big.Int)
	pKey.PublicKey.N.SetString(m["PublicKeyN"], 10)
	pKey.Lambda = new(big.Int)
	pKey.Lambda.SetString(m["Lambda"], 10)
	pKey.Phi = new(big.Int)
	pKey.Phi.SetString(m["Phi"], 10)
	pKey.P = new(big.Int)
	pKey.P.SetString(m["P"], 10)
	pKey.Q = new(big.Int)
	pKey.Q.SetString(m["Q"], 10)

	return pKey, nil
}

func NewPreParamsWithDlnProof() *PreParamsWithDlnProof {
	return GeneratePreParamsWithDlnProof()
}

func MarshalPreParamsWithDlnProof(proof *PreParamsWithDlnProof) ([]byte, error) {
	m := make(map[string]interface{})
	m["NTildei"] = proof.Params.NTildei.String()
	m["H1i"] = proof.Params.H1i.String()
	m["H2i"] = proof.Params.H2i.String()
	m["Alpha"] = proof.Params.Alpha.String()
	m["Beta"] = proof.Params.Beta.String()
	m["P"] = proof.Params.P.String()
	m["Q"] = proof.Params.Q.String()

	alpha := make([]string, 0)
	for i := 0; i < zkp.Iterations; i++ {
		alpha = append(alpha, proof.Proof.Alpha[i].String())
	}
	m["ProofAlpha"] = alpha

	t := make([]string, 0)
	for i := 0; i < zkp.Iterations; i++ {
		t = append(t, proof.Proof.T[i].String())
	}
	m["ProofT"] = t

	return json.Marshal(m)
}

func UnMarshalPreParamsWithDlnProof(bs []byte) (*PreParamsWithDlnProof, error) {
	p := &PreParamsAndProofMal{}
	err := json.Unmarshal(bs, p)
	if err != nil {
		return nil, err
	}

	proof := new(PreParamsWithDlnProof)
	proof.Params = new(PreParams)
	proof.Proof = new(zkp.DlnProof)

	proof.Params.NTildei = new(big.Int)
	proof.Params.NTildei.SetString(p.NTildei, 10)
	proof.Params.H1i = new(big.Int)
	proof.Params.H1i.SetString(p.H1i, 10)
	proof.Params.H2i = new(big.Int)
	proof.Params.H2i.SetString(p.H2i, 10)
	proof.Params.Alpha = new(big.Int)
	proof.Params.Alpha.SetString(p.Alpha, 10)
	proof.Params.Beta = new(big.Int)
	proof.Params.Beta.SetString(p.Beta, 10)
	proof.Params.P = new(big.Int)
	proof.Params.P.SetString(p.P, 10)
	proof.Params.Q = new(big.Int)
	proof.Params.Q.SetString(p.Q, 10)

	for i := 0; i < zkp.Iterations; i++ {
		proof.Proof.Alpha[i] = new(big.Int)
		proof.Proof.Alpha[i].SetString(p.ProofAlpha[i], 10)
	}

	for i := 0; i < zkp.Iterations; i++ {
		proof.Proof.T[i] = new(big.Int)
		proof.Proof.T[i].SetString(p.ProofT[i], 10)
	}

	return proof, nil
}
